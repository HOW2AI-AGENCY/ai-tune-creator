# –ê—É–¥–∏—Ç —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ø–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Telegram Mini App

## üìã –ê–£–î–ò–¢ –¢–ï–ö–£–©–ï–ô –°–ò–°–¢–ï–ú–´ –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò

### ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

#### 1. **–ë–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**
- `src/hooks/useAuth.tsx` - —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ö—É–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `src/pages/Auth.tsx` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `src/components/auth/AuthForm.tsx` - —Ñ–æ—Ä–º–∞ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å —Å–æ—Ü–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ email/password, Spotify, Google, Apple OAuth

#### 2. **Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (—á–∞—Å—Ç–∏—á–Ω–æ)**
- `index.html` - –ø–æ–¥–∫–ª—é—á–µ–Ω Telegram Web App SDK
- `src/hooks/useTelegramWebApp.tsx` - –±–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Telegram API
- `supabase/functions/telegram-auth/index.ts` - Edge Function –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ Telegram auth
- `src/lib/telegram.ts` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è Telegram Bot

#### 3. **Supabase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**
- –ù–∞—Å—Ç—Ä–æ–µ–Ω Supabase client —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Å–µ—Å—Å–∏–∏
- –°–æ–∑–¥–∞–Ω—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- Edge Functions –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ CORS –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏

### ‚ùå –ß—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:

#### 1. **–ó–∞—â–∏—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤**
- –ù–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ `ProtectedRoute` –¥–ª—è –∑–∞—â–∏—Ç—ã –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- –ù–µ—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ `/auth`
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

#### 2. **Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Telegram Mini App –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –≤—Ö–æ–¥–∞ (–±—Ä–∞—É–∑–µ—Ä vs Telegram)
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è Telegram –¥–∞–Ω–Ω—ã—Ö
- –ù–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É Telegram –∏ Supabase auth

#### 3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ edge cases**
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ù–µ—Ç fallback —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –¥–ª—è failed auth
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

---

## üéØ –ü–õ–ê–ù –ò–ù–¢–ï–ì–†–ê–¶–ò–ò TELEGRAM MINI APP –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò

### **–§–ê–ó–ê 1: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—â–∏—â–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤**

#### ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ:
1. **–°–æ–∑–¥–∞–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `ProtectedRoute`**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ loading —Å–æ—Å—Ç–æ—è–Ω–∏–π
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—É–±–ª–∏—á–Ω—ã—Ö –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤

2. **–û–±–Ω–æ–≤–ª–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ App.tsx**
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω `ProtectedRoute` –≤–æ –≤—Å–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
   - –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

3. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Edge Functions**
   - –î–æ–±–∞–≤–ª–µ–Ω `telegram-auth` –≤ `supabase/config.toml` —Å `verify_jwt = false`

### **–§–ê–ó–ê 2: –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ Telegram auth —Ö—É–∫–∞**

#### ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ:
1. **–°–æ–∑–¥–∞–Ω `useTelegramAuth` —Ö—É–∫**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ Telegram —Å—Ä–µ–¥—ã
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è `initData` –∏–∑ Telegram WebApp
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –≤ Telegram
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∑–∞–≥—Ä—É–∑–∫–∏

2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AuthForm**
   - –û–±–Ω–æ–≤–ª–µ–Ω `AuthForm` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ö—É–∫–∞
   - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ Telegram –∫–Ω–æ–ø–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
   - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π

### **–§–ê–ó–ê 3: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –≤—Ö–æ–¥–∞**

#### üöÄ –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

#### 3.1 **–°—Ü–µ–Ω–∞—Ä–∏–π 1: –í—Ö–æ–¥ —á–µ—Ä–µ–∑ Telegram Mini App**
```typescript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å:
// 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Telegram
// 2. useTelegramAuth –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç Telegram —Å—Ä–µ–¥—É
// 3. –ò–∑–≤–ª–µ–∫–∞–µ—Ç initData –∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
// 4. –í—ã–∑—ã–≤–∞–µ—Ç telegram-auth Edge Function
// 5. –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å Telegram Bot API
// 6. –°–æ–∑–¥–∞–µ—Ç/–Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Supabase
// 7. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–µ—Å—Å–∏—é –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é
```

#### 3.2 **–°—Ü–µ–Ω–∞—Ä–∏–π 2: –í—Ö–æ–¥ —á–µ—Ä–µ–∑ –≤–µ–±-–±—Ä–∞—É–∑–µ—Ä**
```typescript
// –û–±—ã—á–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å:
// 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä
// 2. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ–ª–Ω–∞—è —Ñ–æ—Ä–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
// 3. –î–æ—Å—Ç—É–ø–Ω—ã email/password + —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
// 4. Telegram –∫–Ω–æ–ø–∫–∞ —Å–∫—Ä—ã—Ç–∞ (isInTelegram = false)
// 5. –û–±—ã—á–Ω—ã–π OAuth/email flow
```

#### 3.3 **–°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞–º–∏**
```typescript
// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–º–µ—à–∞–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤:
// 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è —á–µ—Ä–µ–∑ web
// 2. –ü–æ–∑–∂–µ –∑–∞—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ Telegram
// 3. –°–∏—Å—Ç–µ–º–∞ —Å–≤—è–∑—ã–≤–∞–µ—Ç –∞–∫–∫–∞—É–Ω—Ç—ã –ø–æ email/user_id
// 4. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—é
```

### **–§–ê–ó–ê 4: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

#### 4.1 **Telegram Data Validation**
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è HMAC-SHA256 –≤ Edge Function
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Bot Token
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç replay –∞—Ç–∞–∫ —á–µ—Ä–µ–∑ timestamp validation

#### 4.2 **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
```typescript
// –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è:
// 1. Rate limiting –¥–ª—è telegram-auth endpoint
// 2. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
// 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ origin –∏ referrer
// 4. Blacklist –¥–ª—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö telegram_id
```

### **–§–ê–ó–ê 5: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞**

#### 5.1 **–ú–µ—Ç—Ä–∏–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**
```sql
-- –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
CREATE TABLE auth_analytics (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  auth_method TEXT NOT NULL, -- 'telegram', 'email', 'oauth'
  success BOOLEAN NOT NULL,
  error_code TEXT,
  telegram_id BIGINT,
  user_agent TEXT,
  ip_address INET,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

#### 5.2 **Dashboard –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**
- –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ –º–µ—Ç–æ–¥–∞–º
- –ì–µ–æ–≥—Ä–∞—Ñ–∏—è –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ß–∞—Å—Ç–æ—Ç–∞ –æ—à–∏–±–æ–∫ –∏ –∏—Ö —Ç–∏–ø—ã
- –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

---

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø

### **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:**

```
src/
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îú‚îÄ‚îÄ useAuth.tsx              # ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π auth state
‚îÇ   ‚îú‚îÄ‚îÄ useTelegramAuth.tsx      # ‚úÖ Telegram-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ useTelegramWebApp.tsx    # ‚úÖ Telegram WebApp API
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îî‚îÄ‚îÄ auth/
‚îÇ       ‚îú‚îÄ‚îÄ ProtectedRoute.tsx   # ‚úÖ –ó–∞—â–∏—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ AuthForm.tsx         # ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞
‚îÇ       ‚îî‚îÄ‚îÄ ConnectionDiagnostics.tsx
‚îî‚îÄ‚îÄ pages/
    ‚îî‚îÄ‚îÄ Auth.tsx                 # ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
```

### **Edge Functions:**

```
supabase/functions/
‚îú‚îÄ‚îÄ telegram-auth/
‚îÇ   ‚îî‚îÄ‚îÄ index.ts                 # ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è Telegram auth
‚îî‚îÄ‚îÄ auth-analytics/              # üìã –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è
    ‚îî‚îÄ‚îÄ index.ts
```

### **–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**

```mermaid
graph TD
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] --> B{–í Telegram?}
    B -->|–î–∞| C[useTelegramAuth]
    B -->|–ù–µ—Ç| D[AuthForm]
    
    C --> E[–ò–∑–≤–ª–µ—á—å initData]
    E --> F[telegram-auth Edge Function]
    F --> G[–í–∞–ª–∏–¥–∞—Ü–∏—è HMAC]
    G --> H[–°–æ–∑–¥–∞—Ç—å/–Ω–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è]
    H --> I[–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Å—Å–∏—é]
    
    D --> J[Email/OAuth]
    J --> K[Supabase Auth]
    K --> I
    
    I --> L[ProtectedRoute]
    L --> M[–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞]
```

---

## ‚úÖ –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°

### **–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- [x] –ö–æ–º–ø–æ–Ω–µ–Ω—Ç ProtectedRoute
- [x] –•—É–∫ useTelegramAuth  
- [x] –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ App.tsx
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AuthForm
- [x] Edge Function telegram-auth
- [x] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤

### **–í –ø—Ä–æ—Ü–µ—Å—Å–µ:**
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ edge cases
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### **–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è:**
- [ ] Auth analytics —Å–∏—Å—Ç–µ–º–∞
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:**
   - –î–æ–±–∞–≤–∏—Ç—å `TELEGRAM_BOT_TOKEN` –≤ Supabase —Å–µ–∫—Ä–µ—Ç—ã
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –≤ Telegram Mini App
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤

2. **–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ (1-2 –¥–Ω—è):**
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
   - –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å UX –ø–µ—Ä–µ—Ö–æ–¥–æ–≤

3. **–°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–æ (1 –Ω–µ–¥–µ–ª—è):**
   - –°–æ–∑–¥–∞—Ç—å –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
   - –î–æ–±–∞–≤–∏—Ç—å A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ flow
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å –ø–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –±–µ—Å—à–æ–≤–Ω–æ–π Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏! üéâ