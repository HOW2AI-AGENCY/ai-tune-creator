# üéµ –°–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º—É–∑—ã–∫–∏ - –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø (v0.01.034)

## üîß **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**

### ‚ùå **–ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã:**

1. **–õ–∏—Ä–∏–∫–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∞—Å—å** - –ø–æ–ª–µ `lyrics` –≤ —Ç–∞–±–ª–∏—Ü–µ `tracks` –±—ã–ª–æ `null`
2. **–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ª–∏—Ä–∏–∫–∏** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `track.lyric` –≤–º–µ—Å—Ç–æ `track.prompt`
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —É–º–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π** - –≤—Å–µ —Ç—Ä–µ–∫–∏ –Ω–∞–∑—ã–≤–∞–ª–∏—Å—å "AI Generated Track"
4. **–û–±–ª–æ–∂–∫–∏ —Ç—Ä–µ–∫–æ–≤ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å** - `image_url` –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª—Å—è

### ‚úÖ **–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**

#### 1. **–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ª–∏—Ä–∏–∫–∏ –∏–∑ Suno API**
```typescript
// –ë–´–õ–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
lyrics: track.lyric || null

// –°–¢–ê–õ–û (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
lyrics: track.prompt || track.lyric || null  // prompt —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏—Ä–∏–∫—É!
```

#### 2. **Smart Title Generation –∏–∑ –ª–∏—Ä–∏–∫–∏**
```typescript
// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–º–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–∑ –ª–∏—Ä–∏–∫–∏
let smartTitle = track.title;
if (track.title === 'AI Generated Track 17.08.2025') {
  const lyrics = track.prompt || track.lyric;
  if (lyrics) {
    // –ò—â–µ–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É –ø–æ—Å–ª–µ [–ö—É–ø–ª–µ—Ç], [Verse], [Intro]
    const lyricsMatch = lyrics.match(/\[(?:–ö—É–ø–ª–µ—Ç|Verse|Intro|–ò–Ω—Ç—Ä–æ|–ü—Ä–∏–ø–µ–≤|Chorus)\s*\d*\]?\s*\n(.+)/i);
    if (lyricsMatch && lyricsMatch[1]) {
      smartTitle = lyricsMatch[1].trim().slice(0, 50);
    } else {
      // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–≤—É—é —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω—É—é —Å—Ç—Ä–æ–∫—É
      const lines = lyrics.split('\n').filter(line => 
        line.trim() && 
        !line.includes('[') && 
        !line.toLowerCase().includes('—Å–æ–∑–¥–∞–π') &&
        line.length > 10
      );
      if (lines.length > 0) {
        smartTitle = lines[0].trim().slice(0, 50);
      }
    }
  }
}
```

#### 3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã Edge Functions:**
- `sync-generated-tracks` - —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –ª–∏—Ä–∏–∫—É
- `suno-callback` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `track.prompt` –¥–ª—è –ª–∏—Ä–∏–∫–∏
- –°–æ–∑–¥–∞–Ω–∞ `fix-existing-tracks-lyrics` –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç—Ä–µ–∫–æ–≤

#### 4. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±–ª–æ–∂–µ–∫ —Ç—Ä–µ–∫–æ–≤**
```typescript
metadata: {
  ...existing_metadata,
  image_url: sunoTrackData?.image_url || sunoTrackData?.sourceImageUrl,
  original_title_generated: smartTitle !== original_title
}
```

## üéØ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–∏—Ä–∏–∫–∏ Suno AI**

### –ü—Ä–∏–º–µ—Ä –ª–∏—Ä–∏–∫–∏ –∏–∑ API:
```
[–ò–Ω—Ç—Ä–æ]
–≠–π–æ –∑–¥–µ—Å—å —è
–í—Ä—ã–≤–∞—é—Å—å –≤ —ç—Ç–æ—Ç —Ç—Ä–µ–∫
–°–Ω–æ–≤–∞

[–ö—É–ø–ª–µ—Ç 1]
–Ø –∏–¥—É –ø–æ –≥–æ—Ä–æ–¥—É –æ–¥–∏–Ω
–ù–æ—á—å –≥–ª—É–±–æ–∫–∞ –≤–æ–∫—Ä—É–≥ –æ–≥–Ω–∏
–í –∫–∞—Ä–º–∞–Ω–µ —Ç–æ–ª—å–∫–æ –≤–µ—Ç–µ—Ä
–ò –º—ã—Å–ª–∏ —á—Ç–æ –ª–µ—Ç—è—Ç –∫–∞–∫ –º–µ—Ç–µ–æ—Ä

[–ü—Ä–∏–ø–µ–≤]
–ú–æ–π –≤–∞–π–± —ç—Ç–æ —Å–≤–æ–±–æ–¥–∞
–ú–æ–π –≤–∞–π–± —ç—Ç–æ –ø–æ–ª—ë—Ç
–í–≤–µ—Ä—Ö –∏ —Ç–æ–ª—å–∫–æ –≤–≤–µ—Ä—Ö
–ù–µ –≤–∏–∂—É —è –ø—Ä–µ–≥—Ä–∞–¥
```

### –õ–æ–≥–∏–∫–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π:
1. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1**: –ï—Å–ª–∏ –≤ –ª–∏—Ä–∏–∫–µ –µ—Å—Ç—å `[–ö—É–ø–ª–µ—Ç 1]` -> –±–µ—Ä–µ–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É –ø–æ—Å–ª–µ –Ω–µ–≥–æ
2. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2**: –ï—Å–ª–∏ –µ—Å—Ç—å `[Intro]` -> –±–µ—Ä–µ–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É –ø–æ—Å–ª–µ –Ω–µ–≥–æ  
3. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3**: –ë–µ—Ä–µ–º –ø–µ—Ä–≤—É—é —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω—É—é —Å—Ç—Ä–æ–∫—É (–¥–ª–∏–Ω–Ω–µ–µ 10 —Å–∏–º–≤–æ–ª–æ–≤, –±–µ–∑ `[...]`)

## üîÑ **–ü—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç—Ä–µ–∫–æ–≤ (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π)**

### 1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é**
```typescript
// –í TrackGenerationSidebar
const { mutate: generateTrack } = useTrackGeneration();
generateTrack({
  prompt: "–°–æ–∑–¥–∞–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ö–∏–ø-—Ö–æ–ø —Ç—Ä–µ–∫",
  style: "hip-hop",
  mode: "quick"
});
```

### 2. **Edge Function —Å–æ–∑–¥–∞–µ—Ç AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—é**
```typescript
// generate-suno-track —Å–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤ ai_generations
{
  service: 'suno',
  prompt: '...',
  status: 'pending',
  external_id: 'task_id_from_suno'
}
```

### 3. **Suno API –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç—Ä–µ–∫ (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)**
- –í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: 30-180 —Å–µ–∫—É–Ω–¥
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ª–∏—Ä–∏–∫—É –≤ –ø–æ–ª–µ `prompt`
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±–ª–æ–∂–∫—É –≤ `image_url`

### 4. **Callback –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç**
```typescript
// suno-callback –ø–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏:
1. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –ª–∏—Ä–∏–∫—É –∏–∑ track.prompt
2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç smart title –∏–∑ –ª–∏—Ä–∏–∫–∏  
3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç—Ä–µ–∫ —Å –ª–∏—Ä–∏–∫–æ–π –∏ —É–º–Ω—ã–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º
4. –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ñ–æ–Ω–æ–≤—É—é –∑–∞–≥—Ä—É–∑–∫—É –∞—É–¥–∏–æ –≤ Supabase Storage
```

### 5. **Sync –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç—Ä–µ–∫–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ**
```typescript
// sync-generated-tracks —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
1. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –ª–∏—Ä–∏–∫—É –∏–∑ metadata.suno_track_data.prompt
2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç smart titles
3. –°–æ–∑–¥–∞–µ—Ç —Ç—Ä–µ–∫–∏ —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
```

## üéµ **–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**

### ‚úÖ **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚ùå –¢—Ä–µ–∫–∏ –±–µ–∑ –ª–∏—Ä–∏–∫–∏
- ‚ùå –ù–∞–∑–≤–∞–Ω–∏—è "AI Generated Track 17.08.2025"  
- ‚ùå –û–±–ª–æ–∂–∫–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å

### ‚úÖ **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚úÖ –õ–∏—Ä–∏–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- ‚úÖ –£–º–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è: "–Ø –∏–¥—É –ø–æ –≥–æ—Ä–æ–¥—É –æ–¥–∏–Ω", "–ú–æ–π –≤–∞–π–± —ç—Ç–æ —Å–≤–æ–±–æ–¥–∞"
- ‚úÖ –û–±–ª–æ–∂–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç—Ä–µ–∫–æ–≤

## üõ† **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**

### 1. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ —Ç—Ä–µ–∫–∞:**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `/generate`
2. –í—ã–±–µ—Ä–∏—Ç–µ Suno AI
3. –í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–ø—Ç: "–°–æ–∑–¥–∞–π —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫—É—é –±–∞–ª–ª–∞–¥—É –æ –ª—é–±–≤–∏"
4. –ù–∞–∂–º–∏—Ç–µ "Generate Track"
5. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (30-60 —Å–µ–∫)
6. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ç—Ä–µ–∫ –∏–º–µ–µ—Ç:
   - ‚úÖ –£–º–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ (–ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –∏–∑ –ª–∏—Ä–∏–∫–∏)
   - ‚úÖ –ü–æ–ª–Ω—É—é –ª–∏—Ä–∏–∫—É —Å —Å–µ–∫—Ü–∏—è–º–∏
   - ‚úÖ –û–±–ª–æ–∂–∫—É (–≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö)

### 2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç—Ä–µ–∫–æ–≤:**
```bash
# –í—ã–∑–æ–≤–∏—Ç–µ Edge Function –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
curl -X POST https://zwbhlfhwymbmvioaikvs.functions.supabase.co/fix-existing-tracks-lyrics \
  -H "Authorization: Bearer YOUR_TOKEN"
```

### 3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏—Ä–∏–∫–∏ –≤ UI:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ª—é–±–æ–π —Ç—Ä–µ–∫ –≤ `/tracks`
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ç—Ä–µ–∫ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π
3. –í–æ –≤–∫–ª–∞–¥–∫–µ "Lyrics" –¥–æ–ª–∂–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –ø–æ–ª–Ω–∞—è –ª–∏—Ä–∏–∫–∞

## üìä **–ú–µ—Ç—Ä–∏–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π**

- **–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã**: 3 Edge Functions
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ç—Ä–µ–∫–∏**: –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –±–µ–∑ –ª–∏—Ä–∏–∫–∏
- **–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**: Smart title generation
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –ø–æ–ª–Ω–∞—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ç—Ä–µ–∫–∞–º–∏

## üéØ **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏**

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏** - —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –Ω–æ–≤—ã–µ —Ç—Ä–µ–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç—Ä–µ–∫–æ–≤** - –∑–∞–ø—É—Å—Ç–∏—Ç—å `fix-existing-tracks-lyrics`
3. **–£–ª—É—á—à–µ–Ω–∏–µ UI** - –¥–æ–±–∞–≤–∏—Ç—å preview –æ–±–ª–æ–∂–µ–∫ —Ç—Ä–µ–∫–æ–≤
4. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ª–∏—Ä–∏–∫–∏** - –¥–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–µ—Å–µ–Ω

---

*–û–±–Ω–æ–≤–ª–µ–Ω–æ: 17 —è–Ω–≤–∞—Ä—è 2025 (v0.01.034)*
*–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –ª–∏—Ä–∏–∫–æ–π —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã ‚úÖ*